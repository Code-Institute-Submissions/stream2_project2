{% extends "base.html" %}

{% block content %}
    
    {% include "profile_menu.html" %} 
    
    <div class="profile-body">
        
        <div class="row row-welcome">
            <div class="col-md-12">
                <h3>Hello {{ user.first_name }}</h3>
            </div>
        </div>
        
        <div class="row mt-4">
            
            <div class="col-md-3">
                
                <img src="{{ MEDIA_URL }}{{ user.profile.image }}" alt="Profile image" width="200px" height="200px" />
                
            </div>
            
            <div class="col-md-3">
                
                <h4>Your Details</h4>
                
                <h6>Username</h6>
                <p>{{ user.username }}</p>
                
                <h6>Role</h6>
                <p>{{ group }}</p>
                
                <h6>First Name</h6>
                <p>{{ user.first_name }}</p>
            
                <h6>Last Name</h6>
                <p>{{ user.last_name }}</p>

                <h6>Phone Number</h6>
                <p>{{ user.profile.phone_number }}</p>

                <h6>Email</h6>
                <p>{{ user.email }}</p>
                
            </div>
            
            <div class="col-md-6">
                    
                <h4>Subscription</h4>
                {% if request.user.profile.subscription_id %} 
                    
                    {% if subscription.status == "active" %}
                        <table class="table profile-user-details ">
                            <tr>
                                <th>Subscription:</th>
                                <td>{{ subscription.plan.nickname }}</td>
                            </tr>
                            <tr>
                                <th>Status:</th>
                                <td>{% if cancelled_on == "not_applicable" %} Active {% else %}<span style="color:#ff0000;">Cancelled on</span> {{ cancelled_on }} {% endif %}</td>
                            </tr>
                            <tr>
                                <th>Valid From:</th>
                                <td>{{ start_date }}</td>
                            </tr>
                            <tr>
                                <th>Valid till:</th>
                                <td>{{ end_date }}</td>
                            </tr>
                            <tr>
                                <th>Auto-Renew on expiry:</th>
                                <td>{% if subscription.cancel_at_period_end == False %}Yes {% else %}No{% endif %}</td>
                            </tr>
                        </table>
                        
                        {% if cancelled_on == "not_applicable" %}
                            <a href="{% url 'unsubscribe' %}" class="btn btn-success">Cancel subscription</a> 
                        {% endif %} 
                        
                    {% elif subscription.status == "canceled" %}
                        <p>Your {{subscription.plan.nickname}} subscription has expired.</p>
                        <p>For further details on our subscription plans and to re-subscribe, please visit our subscriptions page.</p>
                        <a href="{% url 'add_credit_card' %}" class="btn btn-success">Subscriptions page</a> 
                    {% endif %}
                        
                {% else %}
                    <p>You are not subscribed.</p>
                    <a href="{% url 'add_credit_card' %}" class="btn btn-success">Subscribe</a> 
                {% endif %}
                
            </div>
            
        </div>
        
        
    </div>
    
    
{% endblock %}